<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{common/layout_4block :: layout(~{::body/content()})}">

<head>
	<title>社員一覧 | 社員管理システム</title>
	<meta charset="UTF-8" />
</head>

<body class="admin user_list">
	<h3>社員一覧画面</h3>
	<th:block th:if="${session.loginUser.authority == 2}">
		<div class="regist_link">
			<a th:href="@{/regist/input}">新規社員登録</a>
		</div>
	</th:block>
	<!--	該当社員が0名の場合-->
	<th:block th:if="${#lists.isEmpty(employees)}">
		<div class="message">
			<p class="back_to_top_message">該当する社員は存在しません。</p>
			<p class="back_to_top_link">
				<a th:href="@{/list}">一覧表示に戻る</a>
			</p>
		</div>
	</th:block>
	<!--	該当社員がいる場合-->
	<table class="list_table" th:if="!${#lists.isEmpty(employees)}">
		<tr>
			<th>社員ID</th>
			<th>社員名</th>

			<!--			独自機能：管理者のみに表示-->
			<th:block th:if="${session.loginUser.authority == 2}">
				<th class="gender">性別</th>
				<th class="address">住所</th>
				<th class="birthday">生年月日</th>
				<th class="authority">権限</th>
			</th:block>
			<!--ヘッダー-->
			<!--全員に表示-->
			<th class="deptName">部署名</th>
			<th class="brName">支店名</th>

			<!--			独自機能：管理者のみに表示-->
			<th:block th:if="${session.loginUser.authority == 2}">
				<th class="button">変更</th>
				<th class="button">削除</th>
			</th:block>
		</tr>
		<!--		全員に表示:従業員ID・名前-->
		<!--		繰り返し文-->
		<tr th:each="employee: ${employees}">
			<td th:text="${employee.empId}"></td>
			<td th:text="${employee.empName}"></td>
			<!--
				th:switchとth:caseはJavaのswitch文の様に条件分岐を表現できる
				この場合はgender=1の場合[男性]、gender=2の場合[女性]と表示される
			-->
			<!--			独自機能：管理者のみに表示：性別・住所・生年月日・権限-->
			<th:block th:if="${session.loginUser.authority == 2}">
				<td th:switch="${employee.gender}">
					<span th:case="1">男性</span>
					<span th:case="2">女性</span>
					<span th:case="3">その他</span>
				</td>

				<td th:text="${employee.address}"></td>
				<td th:text="${#dates.format(employee.birthday, 'yyyy/MM/dd')}">
				</td>
				<td th:switch="${employee.authority}">
					<span th:case="1">一般</span>
					<span th:case="2">管理者</span>
				</td>
			</th:block>

			<!--			全員に表示:部署名、独自機能：支店名）-->
			<!--			BeanManagerより情報持ってきている-->
			<td th:text="${employee.deptName}"></td>

			<td th:text="${employee.brName}"></td>

			<!--数字で取得したい場合はbrId-->
			<!--<td th:switch="${employee.brId}">-->
			<!--<span th:case="1">東京支店</span>-->
			<!--<span th:case="2">大阪支店</span>-->
			<!--<span th:case="3">愛知支店</span>-->
			<!--<span th:case="4">福岡支店</span>-->
			<!--<span th:case="5">広島支店</span>-->
			<!--<span th:case="6">北海道支店</span>-->
			<!--<span th:case="7">沖縄支店</span>-->
			<!--</td>-->


			<!--			独自機能：管理者のみに表示:更新-->
			<th:block th:if="${session.loginUser.authority == 2}">
				<td>
					<form method="get" th:action="@{/update/input}">
						<input type="hidden" name="empId" th:value="${employee.empId}" />
						<input type="submit" value="変更" />
					</form>
				</td>
				<!--			独自機能：管理者のみに表示:削除-->
				<td>
					<form method="get" th:action="@{/delete/check}">
						<input type="hidden" name="empId" th:value="${employee.empId}" />
						<input type="submit" value="削除" class="delete" />
					</form>
				</td>
			</th:block>
		</tr>
	</table>
</body>

</html>